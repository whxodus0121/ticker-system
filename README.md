# 🎫 티켓 예매 동시성 제어 프로젝트 (Ticket-System)

이 프로젝트는 동시성 요청이 발생하는 티켓 예매 상황에서 데이터의 정합성을 보장하고, 
시스템 부하를 최소화하는 과정을 단계별로 해결해 나가는 백엔드 시스템입니다.

## 📌 버전별 개발 기록 (Tags)

### 🔴 v1.0: 인프라 구축 및 기본 연동
- **주요 내용**: Redis 분산 락 및 MySQL 연동 완료
- **학습 포인트**: Docker를 이용한 Redis, MySQL 환경 구축 및 Go 언어와의 기본적인 커넥션 설정

### 🟡 v2.0: 동시성 이슈 해결 (초과 판매 방지)
- **주요 내용**: 초과 판매 방지, DB 연결 폭주 에러 해결, 예매 성공 명단 관리
- **해결 방법**: 
  - Redis 분산 락을 통한 재고 차감의 원자성 보장
  - DB 커넥션 풀 최적화로 `Too many connections` 에러 해결
- **결과**: 동시에 1,000명이 접속해도 설정된 재고만큼만 정확히 판매됨을 확인

### 🟢 v3.0: 비즈니스 정책 적용 (1인 1매 제한)
- **주요 내용**: 1인 1매 중복 방지 로직 추가
- **해결 방법**: 
  - **Double-Checked Locking**: 락 획득 전후로 구매 이력을 확인하여 중복 예매를 원천 차단
  - 고부하 상황에서 발생하는 **Slow SQL** 로그 분석을 통해 성능 병목 지점 파악
- **결과**: 동일 아이디로 무한 요청을 보내도 오직 1건의 구매 데이터만 남도록 보장

### 🔵 v4.0: 티켓 취소 로직 구현 및 시스템 성능 한계 도출
- **주요 내용**: 예매 취소 기능 구현 및 Redis-DB 간 데이터 정합성 보장
- **해결 방법**: 
  - 취소 프로세스 설계: MySQL 구매 내역 삭제 → Redis 재고 복구(+1) → Redis 구매자 명단 제거의 순차적 흐름 구현
  - 데이터 정합성 검증: DB에 실제 구매 내역이 있는 경우에만 취소를 승인하여, 비정상적인 재고 증가(Over-stocking)를 원천 차단
  - ⚠️ 직면한 문제 (Slow SQL 재발)
  - 현상: 동시 예매 테스트 시 MySQL INSERT 과정에서 0.5s 이상의 지연이 발생하는 Slow SQL 재발 확인
  - 원인 분석: Redis의 인메모리 처리 속도와 MySQL의 디스크 I/O 처리 속도 차이로 인한 동기식 저장의 병목 현상 발생
- **결과**: 예매와 취소의 전체 사이클은 완성되었으나, 고부하 환경에서의 안정적인 쓰기 성능을 위해 비동기 메시지 큐(Kafka) 도입의 필요성을 기술적으로 도출

---
## 🛠 Tech Stack
- **Language**: Go (Golang)
- **Database**: MySQL 8.0 (GORM)
- **Cache & Lock**: Redis
- **Container**: Docker, WSL2
- **Test**: Stress Testing with Goroutines

## 🚦 실행 방법 (How to Run)
1. **Docker 컨테이너 실행**
   ```bash
   docker start my-mysql my-redis
